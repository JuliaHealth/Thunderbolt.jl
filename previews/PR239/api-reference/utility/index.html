<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utility · Thunderbolt.jl</title><meta name="title" content="Utility · Thunderbolt.jl"/><meta property="og:title" content="Utility · Thunderbolt.jl"/><meta property="twitter:title" content="Utility · Thunderbolt.jl"/><meta name="description" content="Documentation for Thunderbolt.jl."/><meta property="og:description" content="Documentation for Thunderbolt.jl."/><meta property="twitter:description" content="Documentation for Thunderbolt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Thunderbolt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Thunderbolt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Continuum Mechanics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/cm01_simple-active-stress/">CM01: Simple Active Stress</a></li><li><a class="tocitem" href="../../tutorials/cm02_prestress/">CM02: Prestressing (WIP)</a></li><li><a class="tocitem" href="../../tutorials/cm03_3d0d-coupling/">CM03: 0D Blood Circuit</a></li><li><a class="tocitem" href="../../tutorials/cm04_pericardium/">CM04: Pericadium (TODO)</a></li><li><a class="tocitem" href="../../tutorials/cm05_fourchambers/">CM05: Four Chamber (TODO)</a></li><li><a class="tocitem" href="../../tutorials/cm06_heartvalves/">CM06: Heart Valves (TODO)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Electrophysiology</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/ep01_spiral-wave/">EP01: Spiral Wave</a></li><li><a class="tocitem" href="../../tutorials/ep02_purkinje/">EP02: Purkinje Network (TODO)</a></li><li><a class="tocitem" href="../../tutorials/ep03_bidomain/">EP03: Defibrillation (TODO)</a></li><li><a class="tocitem" href="../../tutorials/ep04_geselowitz-ecg/">EP04: Monodomain ECG</a></li><li><a class="tocitem" href="../../tutorials/ep05_eikonal/">EP05: Eikonal Models (WIP)</a></li><li><a class="tocitem" href="../../tutorials/ep06_pacemaker/">EP06: Pacemakers (TODO)</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Topic Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../topics/">Overview</a></li><li><a class="tocitem" href="../../topics/operators/">Operators</a></li><li><a class="tocitem" href="../../topics/couplers/">Couplers</a></li><li><a class="tocitem" href="../../topics/time-integration/">Time Integration</a></li><li><a class="tocitem" href="../../topics/nonlinear-solver/">Nonlinear Solver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/">Overview</a></li><li><a class="tocitem" href="../../howto/benchmarking/">Benchmarking</a></li><li><a class="tocitem" href="../../howto/custom-ep-cell-model/">Adding EP Cell Models</a></li><li><a class="tocitem" href="../../howto/custom-stimulation-protocols/">Custom Stimulation Protocols</a></li><li><a class="tocitem" href="../../howto/custom-energies/">Adding Energies</a></li><li><a class="tocitem" href="../../howto/custom-sarcomere/">Adding Sarcomeres</a></li><li><a class="tocitem" href="../../howto/custom-elements/">Adding New Elements</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../mesh/">Mesh</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../problems/">Problems</a></li><li><a class="tocitem" href="../discretization/">Discretization</a></li><li><a class="tocitem" href="../operators/">Operators</a></li><li><a class="tocitem" href="../solver/">Solver</a></li><li class="is-active"><a class="tocitem" href>Utility</a><ul class="internal"><li><a class="tocitem" href="#Collections"><span>Collections</span></a></li><li><a class="tocitem" href="#Iteration"><span>Iteration</span></a></li><li><a class="tocitem" href="#IO"><span>IO</span></a></li><li><a class="tocitem" href="#Transfer-Operators"><span>Transfer Operators</span></a></li><li><a class="tocitem" href="#Postprocessing"><span>Postprocessing</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devdocs/">Overview</a></li><li><a class="tocitem" href="../../devdocs/element_interface/">Element Interface</a></li><li><a class="tocitem" href="../../devdocs/domain_management/">Domain management</a></li></ul></li><li><a class="tocitem" href="../../vroom/">Performance Tips</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Utility</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Utility</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaHealth/Thunderbolt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/main/docs/src/api-reference/utility.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Utility"><a class="docs-heading-anchor" href="#Utility">Utility</a><a id="Utility-1"></a><a class="docs-heading-anchor-permalink" href="#Utility" title="Permalink"></a></h1><h2 id="Collections"><a class="docs-heading-anchor" href="#Collections">Collections</a><a id="Collections-1"></a><a class="docs-heading-anchor-permalink" href="#Collections" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thunderbolt.InterpolationCollection"><a class="docstring-binding" href="#Thunderbolt.InterpolationCollection"><code>Thunderbolt.InterpolationCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">InterpolationCollection</code></pre><p>A collection of compatible interpolations over some (possilby different) cells.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L1-L5">source</a></div></details></article><div class="admonition is-warning" id="Missing-docstring.-99d902eb9dc15e5e"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-99d902eb9dc15e5e" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>getinterpolation</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="Thunderbolt.ScalarInterpolationCollection"><a class="docstring-binding" href="#Thunderbolt.ScalarInterpolationCollection"><code>Thunderbolt.ScalarInterpolationCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">ScalarInterpolationCollection</code></pre><p>A collection of compatible scalar-valued interpolations over some (possilby different) cells.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L8-L12">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.VectorInterpolationCollection"><a class="docstring-binding" href="#Thunderbolt.VectorInterpolationCollection"><code>Thunderbolt.VectorInterpolationCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">VectorInterpolationCollection</code></pre><p>A collection of compatible vector-valued interpolations over some (possilby different) cells.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L15-L19">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.VectorizedInterpolationCollection"><a class="docstring-binding" href="#Thunderbolt.VectorizedInterpolationCollection"><code>Thunderbolt.VectorizedInterpolationCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">VectorizedInterpolationCollection{order} &lt;: InterpolationCollection</code></pre><p>A collection of fixed-order vectorized Lagrange interpolations across different cell types.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L50-L54">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.LagrangeCollection"><a class="docstring-binding" href="#Thunderbolt.LagrangeCollection"><code>Thunderbolt.LagrangeCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">LagrangeCollection{order} &lt;: InterpolationCollection</code></pre><p>A collection of fixed-order Lagrange interpolations across different cell types.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L25-L29">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.QuadratureRuleCollection"><a class="docstring-binding" href="#Thunderbolt.QuadratureRuleCollection"><code>Thunderbolt.QuadratureRuleCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">QuadratureRuleCollection(order::Int)</code></pre><p>A collection of quadrature rules across different cell types.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L69-L73">source</a></div></details></article><div class="admonition is-warning" id="Missing-docstring.-caf76f7f6f820556"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-caf76f7f6f820556" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>getquadraturerule</code>. Check Documenter&#39;s build log for details.</p></div></div><article><details class="docstring" open="true"><summary id="Thunderbolt.CellValueCollection"><a class="docstring-binding" href="#Thunderbolt.CellValueCollection"><code>Thunderbolt.CellValueCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">CellValueCollection(::QuadratureRuleCollection, ::InterpolationCollection)</code></pre><p>Helper to construct and query the correct cell values on mixed grids.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L117-L121">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.FacetValueCollection"><a class="docstring-binding" href="#Thunderbolt.FacetValueCollection"><code>Thunderbolt.FacetValueCollection</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">FacetValueCollection(::QuadratureRuleCollection, ::InterpolationCollection)</code></pre><p>Helper to construct and query the correct facet values on mixed grids.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/collections.jl#L135-L139">source</a></div></details></article><h2 id="Iteration"><a class="docs-heading-anchor" href="#Iteration">Iteration</a><a id="Iteration-1"></a><a class="docs-heading-anchor-permalink" href="#Iteration" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thunderbolt.QuadraturePoint"><a class="docstring-binding" href="#Thunderbolt.QuadraturePoint"><code>Thunderbolt.QuadraturePoint</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">QuadraturePoint{dim, T}</code></pre><p>A simple helper to carry quadrature point information.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/quadrature_iterator.jl#L1-L5">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.QuadratureIterator"><a class="docstring-binding" href="#Thunderbolt.QuadratureIterator"><code>Thunderbolt.QuadratureIterator</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">QuadratureIterator(::QuadratureRule)
QuadratureIterator(::FacetQuadratureRule, local_facet_idx::Int)
QuadratureIterator(::CellValues)
QuadratureIterator(::FacetValues)</code></pre><p>A helper to loop over the quadrature points in some rule or cache with type <a href="#Thunderbolt.QuadraturePoint"><code>QuadraturePoint</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/quadrature_iterator.jl#L11-L18">source</a></div></details></article><h2 id="IO"><a class="docs-heading-anchor" href="#IO">IO</a><a id="IO-1"></a><a class="docs-heading-anchor-permalink" href="#IO" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thunderbolt.ParaViewWriter"><a class="docstring-binding" href="#Thunderbolt.ParaViewWriter"><code>Thunderbolt.ParaViewWriter</code></a> — <span class="docstring-category">Type</span></summary><div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/io.jl#L1">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.JLD2Writer"><a class="docstring-binding" href="#Thunderbolt.JLD2Writer"><code>Thunderbolt.JLD2Writer</code></a> — <span class="docstring-category">Type</span></summary><div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/io.jl#L137">source</a></div></details></article><div class="admonition is-warning" id="Missing-docstring.-d013e645e20e6668"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-d013e645e20e6668" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>store_timestep!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-819ae877e5d47a4b"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-819ae877e5d47a4b" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>store_timestep_celldata!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-206afc769763d939"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-206afc769763d939" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>store_timestep_field!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-a12e80634880058a"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-a12e80634880058a" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>store_coefficient!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-6f8c29760d289dbc"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-6f8c29760d289dbc" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>store_green_lagrange!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-124c70b4f25be6b0"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-124c70b4f25be6b0" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>finalize_timestep!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning" id="Missing-docstring.-8aaf70e1823a24a4"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-8aaf70e1823a24a4" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>finalize!</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Transfer-Operators"><a class="docs-heading-anchor" href="#Transfer-Operators">Transfer Operators</a><a id="Transfer-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Transfer-Operators" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thunderbolt.NodalIntergridInterpolation"><a class="docstring-binding" href="#Thunderbolt.NodalIntergridInterpolation"><code>Thunderbolt.NodalIntergridInterpolation</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">NodalIntergridInterpolation(dh_from::DofHandler{sdim}, dh_to::DofHandler{sdim}, field_name_from::Symbol, field_name_to::Symbol; subdomain_from = 1:length(dh_from.subdofhandlers), subdomains_to = 1:length(dh_to.subdofhandlers))
NodalIntergridInterpolation(dh_from::DofHandler{sdim}, dh_to::DofHandler{sdim}, field_name::Symbol; subdomain_from = 1:length(dh_from.subdofhandlers), subdomains_to = 1:length(dh_to.subdofhandlers))
NodalIntergridInterpolation(dh_from::DofHandler{sdim}, dh_to::DofHandler{sdim}; subdomain_from = 1:length(dh_from.subdofhandlers), subdomains_to = 1:length(dh_to.subdofhandlers))</code></pre><p>Construct a transfer operator to move a field <code>field_name</code> from dof handler <code>dh_from</code> to another dof handler <code>dh_to</code>, assuming that all spatial coordinates of the dofs for <code>dh_to</code> are in the interior or boundary of the mesh contained within dh_from. This is necessary to have valid interpolation values, as this operator does not have extrapolation functionality.</p><div class="admonition is-info" id="Note-ab1ac3162320445f"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ab1ac3162320445f" title="Permalink"></a></header><div class="admonition-body"><p>We assume a continuous coordinate field, if the interpolation of the named field is continuous.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/transfer_operators.jl#L31-L43">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.transfer!"><a class="docstring-binding" href="#Thunderbolt.transfer!"><code>Thunderbolt.transfer!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">This is basically a fancy matrix-vector product to transfer the solution from one problem to another one.</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/ferrite-addons/transfer_operators.jl#L123-L125">source</a></div></details></article><h2 id="Postprocessing"><a class="docs-heading-anchor" href="#Postprocessing">Postprocessing</a><a id="Postprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocessing" title="Permalink"></a></h2><h3 id="ECG"><a class="docs-heading-anchor" href="#ECG">ECG</a><a id="ECG-1"></a><a class="docs-heading-anchor-permalink" href="#ECG" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thunderbolt.PoissonECGReconstructionCache"><a class="docstring-binding" href="#Thunderbolt.PoissonECGReconstructionCache"><code>Thunderbolt.PoissonECGReconstructionCache</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">PoissonECGReconstructionCache(fₑₚ::GenericSplitFunction, Ωₜ::AbstractMesh, κᵢ, κ, electrodes::AbstractVector{&lt;:Vec}; ground, linear_solver, solution_vector_type, system_matrix_type)</code></pre><p>Sets up a cache for calculating <span>$\varphi_\mathrm{e}$</span> by solving the Poisson problem</p><p class="math-container">\[\nabla \cdot (\boldsymbol{\kappa}_{\mathrm{i}} + \boldsymbol{\kappa}_{\mathrm{e}}) \nabla \varphi_{\mathrm{e}}=-\nabla \cdot\left(\boldsymbol{\kappa}_{\mathrm{i}} \nabla \varphi_\mathrm{m}\right)\]</p><p>as for example proposed in [<a href="../../references/#PotDubRicVinGul_2006_cmb">26</a>] and investigated in [<a href="../../references/#OgiBalPer_2021_ema">27</a>] (as well as other studies). Here κₑ is the extracellular conductivity tensor and κᵢ is the intracellular conductivity tensor. The cache includes the assembled stiffness matrix with applied homogeneous Dirichlet boundary condition at the first vertex of the mesh. As the problem is solved for each timestep with only the right hand side changing.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>ground               = Set([VertexIndex(1, 1)])</code></li><li><code>linear_solver        = LinearSolve.KrylovJL_CG()</code></li><li><code>solution_vector_type = Vector{Float64}</code></li><li><code>system_matrix_type   = ThreadedSparseMatrixCSR{Float64,Int64}</code></li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/modeling/electrophysiology/ecg.jl#L138-L154">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.Plonsey1964ECGGaussCache"><a class="docstring-binding" href="#Thunderbolt.Plonsey1964ECGGaussCache"><code>Thunderbolt.Plonsey1964ECGGaussCache</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">Plonsey1964ECGGaussCache(op::AbstractBilinearOperator, φₘ::AbstractVector)</code></pre><p>Here φₘ is the solution vector containing the transmembranepotential, op is the associated diffusion opeartor and κₜ is the torso&#39;s conductivity.</p><p>Returns a cache to compute the lead field with the form proposed in [<a href="../../references/#Plo_1964_vcf">28</a>] with the Gauss theorem applied to it, as for example described in [<a href="../../references/#OgiBalPer_2021_ema">27</a>]. Calling <a href="#Thunderbolt.evaluate_ecg"><code>evaluate_ecg</code></a> with this method simply evaluates the following integral efficiently:</p><p class="math-container">\[\varphi_e(x)=\frac{1}{4 \pi \kappa_t} \int_\Omega \frac{ \kappa_ ∇φₘ \cdot (\tilde{x}-x)}{||(\tilde{x}-x)||^3}\mathrm{d}\tilde{x}\]</p><p>The important simplifications taken are:</p><ol><li>Surrounding volume is an infinite, homogeneous sphere with isotropic conductivity</li><li>The extracellular space and surrounding volume share the same isotropic, homogeneous conductivity tensor</li></ol><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/modeling/electrophysiology/ecg.jl#L33-L48">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.Geselowitz1989ECGLeadCache"><a class="docstring-binding" href="#Thunderbolt.Geselowitz1989ECGLeadCache"><code>Thunderbolt.Geselowitz1989ECGLeadCache</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">Geselowitz1989ECGLeadCache(problem, torso_grid, κ, κᵢ, electrode_sets, [ground, linear_solver, solution_vector_type, system_matrix_type])</code></pre><p>Here the lead field, <code>Z</code>, is computed using the discretization of <code>problem</code>. The lead field is computed as the solution of</p><p class="math-container">\[\nabla \cdot(\mathbf{\kappa} \nabla Z)=\left\{\begin{array}{cl}
-1 &amp; \text { at the positive electrode } \\
1 &amp; \text { at the negative electrode } \\
0 &amp; \text { else where }
\end{array}\right.\]</p><p>Where <span>$\kappa$</span> is the bulk conductivity tensor.</p><p>Returns a cache contain the lead fields that are used to compute the lead potentials as proposed in [<a href="../../references/#Ges_1989_ote">29</a>]. Calling <a href="@ref"><code>reinit!</code></a> with this method simply evaluates the following integral efficiently:</p><p class="math-container">\[V(t)=\int \nabla Z(\boldsymbol{x}) \cdot \boldsymbol{\kappa}_\mathrm{i} \nabla \varphi_\mathrm{m} \,\mathrm{d}\boldsymbol{x}.\]</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/modeling/electrophysiology/ecg.jl#L332-L352">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Thunderbolt.evaluate_ecg"><a class="docstring-binding" href="#Thunderbolt.evaluate_ecg"><code>Thunderbolt.evaluate_ecg</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">evaluate_ecg(method::Plonsey1964ECGGaussCache, x::Vec, κₜ::Real)</code></pre><p>Compute the pseudo ECG at a given point x by evaluating:</p><p class="math-container">\[\varphi_e(x)=\frac{1}{4 \pi \kappa_t} \int_\Omega \frac{ \kappa_ ∇φₘ \cdot (\tilde{x}-x)}{||(\tilde{x}-x)||^3}\mathrm{d}\tilde{x}\]</p><p>For more information please read the docstring for <a href="#Thunderbolt.Plonsey1964ECGGaussCache"><code>Plonsey1964ECGGaussCache</code></a></p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/Thunderbolt.jl/blob/d1a53ac912a516f840014cb0f668c628d507f4d0/src/modeling/electrophysiology/ecg.jl#L65-L73">source</a></div></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solver/">« Solver</a><a class="docs-footer-nextpage" href="../../devdocs/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Tuesday 2 December 2025 08:20">Tuesday 2 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
